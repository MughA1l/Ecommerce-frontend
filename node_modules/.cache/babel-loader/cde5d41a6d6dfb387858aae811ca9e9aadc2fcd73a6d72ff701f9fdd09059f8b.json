{"ast":null,"code":"// ShopContextProvider.jsx\nimport React,{createContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const ShopContextProvider=props=>{const[all_product,setAll_product]=useState([]);const[cartItems,setcartItems]=useState({});useEffect(()=>{fetch('http://localhost:4000/allproducts').then(response=>response.json()).then(data=>{if(Array.isArray(data)){setAll_product(data);}else{console.error('Fetched data is not an array:',data);}}).catch(error=>console.error('Error fetching products:',error));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/getcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:\"\"}).then(response=>response.json()).then(data=>setcartItems(data));}},[]);const addtocart=itemId=>{setcartItems(prev=>({...prev,[itemId]:(prev[itemId]||0)+1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/addtocart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const removefromcart=itemId=>{setcartItems(prev=>({...prev,[itemId]:(prev[itemId]||0)-1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/removefromcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const gettotalcartamount=()=>{let totalamount=0;for(const item in cartItems){let iteminfo=all_product.find(product=>product.id===Number(item));if(iteminfo){totalamount+=iteminfo.new_price*cartItems[item];}}return totalamount;};const gettotalcartitem=()=>{let totalitem=0;for(const item in cartItems){if(cartItems[item]>0){totalitem+=cartItems[item];}}return totalitem;};const contextValue={all_product,cartItems,addtocart,removefromcart,gettotalcartamount,gettotalcartitem};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;","map":{"version":3,"names":["React","createContext","useEffect","useState","jsx","_jsx","ShopContext","ShopContextProvider","props","all_product","setAll_product","cartItems","setcartItems","fetch","then","response","json","data","Array","isArray","console","error","catch","localStorage","getItem","method","headers","Accept","concat","body","addtocart","itemId","prev","JSON","stringify","log","removefromcart","gettotalcartamount","totalamount","item","iteminfo","find","product","id","Number","new_price","gettotalcartitem","totalitem","contextValue","Provider","value","children"],"sources":["D:/ecommerce/frontend/src/contexts/ShopContexts/Shopcontext.jsx"],"sourcesContent":["// ShopContextProvider.jsx\r\nimport React, { createContext, useEffect, useState } from 'react';\r\n\r\nexport const ShopContext = createContext(null);\r\n\r\nconst ShopContextProvider = (props) => {\r\n  const [all_product, setAll_product] = useState([]);\r\n  const [cartItems, setcartItems] = useState({});\r\n\r\n  useEffect(() => {\r\n    fetch('http://localhost:4000/allproducts')\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        if (Array.isArray(data)) {\r\n          setAll_product(data);\r\n        } else {\r\n          console.error('Fetched data is not an array:', data);\r\n        }\r\n      })\r\n      .catch((error) => console.error('Error fetching products:', error));\r\n\r\n      if(localStorage.getItem('auth-token')){\r\n        fetch('http://localhost:4000/getcart',{\r\n          method:'POST',\r\n          headers:{\r\n            Accept:'application/form-data',\r\n            'auth-token':`${localStorage.getItem('auth-token')}`,\r\n            'Content-Type':'application/json'\r\n          },\r\n          body:\"\",\r\n        }).then((response)=>response.json())\r\n        .then((data)=>setcartItems(data));\r\n      }\r\n  }, []);\r\n\r\n  const addtocart = (itemId) => {\r\n    setcartItems((prev) => ({ ...prev, [itemId]: (prev[itemId] || 0) + 1 }));\r\n    if (localStorage.getItem('auth-token')) {\r\n      fetch('http://localhost:4000/addtocart', {\r\n        method: 'POST',\r\n        headers: {\r\n          Accept: 'application/form-data',\r\n          'auth-token': `${localStorage.getItem('auth-token')}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ \"itemId\": itemId }),\r\n      })\r\n      .then((response) => response.json())\r\n      .then((data) => console.log(data));\r\n    }\r\n  }\r\n\r\n  const removefromcart = (itemId) => {\r\n    setcartItems((prev) => ({ ...prev, [itemId]: (prev[itemId] || 0) - 1 }));\r\n    if(localStorage.getItem('auth-token')){\r\n      fetch('http://localhost:4000/removefromcart', {\r\n        method: 'POST',\r\n        headers: {\r\n          Accept: 'application/form-data',\r\n          'auth-token': `${localStorage.getItem('auth-token')}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ \"itemId\": itemId }),\r\n      })\r\n      .then((response) => response.json())\r\n      .then((data) => console.log(data));\r\n    }\r\n  }\r\n\r\n  const gettotalcartamount = () => {\r\n    let totalamount = 0;\r\n    for (const item in cartItems) {\r\n      let iteminfo = all_product.find((product) => product.id === Number(item));\r\n      if (iteminfo) {\r\n        totalamount += iteminfo.new_price * cartItems[item];\r\n      }\r\n    }\r\n    return totalamount;\r\n  }\r\n\r\n  const gettotalcartitem = () => {\r\n    let totalitem = 0;\r\n    for (const item in cartItems) {\r\n      if (cartItems[item] > 0) {\r\n        totalitem += cartItems[item];\r\n      }\r\n    }\r\n    return totalitem;\r\n  }\r\n\r\n  const contextValue = { all_product, cartItems, addtocart, removefromcart, gettotalcartamount, gettotalcartitem };\r\n\r\n  return (\r\n    <ShopContext.Provider value={contextValue}>\r\n      {props.children}\r\n    </ShopContext.Provider>\r\n  );\r\n}\r\n\r\nexport default ShopContextProvider;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}